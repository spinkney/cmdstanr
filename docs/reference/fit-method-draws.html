<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Extract posterior draws — fit-method-draws • cmdstanr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Extract posterior draws — fit-method-draws" />
<meta property="og:description" content="Extract posterior draws after MCMC or approximate posterior
draws after variational approximation using formats provided by the
posterior package.
The variables include the parameters, transformed parameters, and
generated quantities from the Stan program as well as lp__, the total
log probability (target) accumulated in the model block." />
<meta property="og:image" content="https://mc-stan.org/cmdstanr/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cmdstanr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/bayesplot">bayesplot</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools">rstantools</a>
    </li>
    <li>
      <a href="https://mc-stan.org/posterior">posterior</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mc-stan.org">Stan</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fas fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/cmdstanr">
    <span class="fas fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/">
    <span class="fas fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract posterior draws</h1>
    <small class="dont-index">Source: <a href='https://github.com/stan-dev/cmdstanr/blob/master/R/fit.R'><code>R/fit.R</code></a></small>
    <div class="hidden name"><code>fit-method-draws.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extract posterior draws after MCMC or approximate posterior
draws after variational approximation using formats provided by the
<span class="pkg">posterior</span> package.</p>
<p>The variables include the <code>parameters</code>, <code>transformed parameters</code>, and
<code>generated quantities</code> from the Stan program as well as <code>lp__</code>, the total
log probability (<code>target</code>) accumulated in the <code>model</code> block.</p>
    </div>

    <pre class="usage"><span class='fu'>draws</span>(
  <span class='kw'>variables</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>inc_warmup</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>format</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span>(<span class='st'>"cmdstanr_draws_format"</span>, <span class='st'>"draws_matrix"</span>)
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>variables</th>
      <td><p>(character vector) The variables to read in. If <code>NULL</code> (the
default) then all variables are included.</p></td>
    </tr>
    <tr>
      <th>inc_warmup</th>
      <td><p>(logical) Should warmup draws be included? Defaults to
<code>FALSE</code>. Ignored except when used with <a href='CmdStanMCMC.html'>CmdStanMCMC</a> objects.</p></td>
    </tr>
    <tr>
      <th>format</th>
      <td><p>(string) The format of the returned draws or point estimates.
Must be a valid format from the <span class="pkg">posterior</span> package. The default can be
set using the option <code>"cmdstanr_draws_format"</code>, otherwise the defaults are
the following.</p><ul>
<li><p>For sampling and generated quantities the default is
<code><a href='https://mc-stan.org/posterior/reference/draws_array.html'>"draws_array"</a></code>.</p></li>
<li><p>For point estimates from optimization and approximate draws from
variational inference the default is
<code><a href='https://mc-stan.org/posterior/reference/draws_array.html'>"draws_matrix"</a></code>.</p></li>
</ul>

<p>To use a different format it can be specified as the full name (e.g.
<code>"draws_df"</code>) or omitting the <code>"draws_"</code> prefix (e.g. <code>"df"</code>).</p>
<p>For models with a large number of parameters (20k+) we recommend using the
<code>draws_list</code> format, which is the most efficient and RAM friendly when
combining draws from multiple chains. If speed or memory is not a
constraint we recommend selecting the format that most suits the coding
style of the post processing phase.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Depends on the value of <code>format</code>. The defaults are:</p><ul>
<li><p>For <a href='model-method-sample.html'>MCMC</a>, a 3-D
<code><a href='https://mc-stan.org/posterior/reference/draws_array.html'>draws_array</a></code> object (iteration x chain x
variable).</p></li>
<li><p>For standalone <a href='model-method-generate-quantities.html'>generated quantities</a>, a
3-D <code><a href='https://mc-stan.org/posterior/reference/draws_array.html'>draws_array</a></code> object (iteration x chain x
variable).</p></li>
<li><p>For <a href='model-method-variational.html'>variational inference</a>, a 2-D
<code><a href='https://mc-stan.org/posterior/reference/draws_matrix.html'>draws_matrix</a></code> object (draw x variable). An
additional variable <code>lp_approx__</code> is also included, which is the log density
of the variational approximation to the posterior evaluated at each of the
draws.</p></li>
<li><p>For <a href='model-method-optimize.html'>optimization</a>, a 1-row
<code><a href='https://mc-stan.org/posterior/reference/draws_matrix.html'>draws_matrix</a></code> with one column per variable. These
are <em>not</em> actually draws, just point estimates stored in the <code>draws_matrix</code>
format. See <code><a href='fit-method-mle.html'>$mle()</a></code> to extract them as a numeric vector.</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='CmdStanMCMC.html'>CmdStanMCMC</a></code>, <code><a href='CmdStanMLE.html'>CmdStanMLE</a></code>, <code><a href='CmdStanVB.html'>CmdStanVB</a></code>, <code><a href='CmdStanGQ.html'>CmdStanGQ</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \dontrun{</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>posterior</span>)
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>bayesplot</span>)
<span class='fu'><a href='https://mc-stan.org/bayesplot/reference/bayesplot-colors.html'>color_scheme_set</a></span>(<span class='st'>"brightblue"</span>)

<span class='co'># logistic regression with intercept alpha and coefficients beta</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='cmdstanr_example.html'>cmdstanr_example</a></span>(<span class='st'>"logistic"</span>)</div><div class='output co'>#&gt; <span class='message'>Model executable is up to date!</span></div><div class='input'>
<span class='co'># returned as 3-D array (see ?posterior::draws_array)</span>
<span class='no'>draws</span> <span class='kw'>&lt;-</span> <span class='no'>fit</span>$<span class='fu'>draws</span>()
<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span>(<span class='no'>draws</span>)</div><div class='output co'>#&gt; [1] 1000    4  105</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>draws</span>)</div><div class='output co'>#&gt;  'draws_array' num [1:1000, 1:4, 1:105] -65.5 -67.3 -65.1 -65.5 -65 ...
#&gt;  - attr(*, "dimnames")=List of 3
#&gt;   ..$ iteration: chr [1:1000] "1" "2" "3" "4" ...
#&gt;   ..$ chain    : chr [1:4] "1" "2" "3" "4"
#&gt;   ..$ variable : chr [1:105] "lp__" "alpha" "beta[1]" "beta[2]" ...</div><div class='input'>
<span class='co'># can easily convert to other formats (data frame, matrix, list)</span>
<span class='fu'><a href='https://mc-stan.org/posterior/reference/draws_df.html'>as_draws_df</a></span>(<span class='no'>draws</span>)  <span class='co'># see also as_draws_matrix, as_draws_list</span></div><div class='output co'>#&gt; # A draws_df: 1000 iterations, 4 chains, and 105 variables
#&gt;    lp__ alpha beta[1] beta[2] beta[3] log_lik[1] log_lik[2] log_lik[3]
#&gt; 1   -66 0.016   -0.76   -0.27   0.554      -0.64      -0.31      -0.60
#&gt; 2   -67 0.831   -0.66   -0.51   1.054      -0.39      -0.41      -0.42
#&gt; 3   -65 0.302   -0.35   -0.45   0.767      -0.61      -0.41      -0.74
#&gt; 4   -66 0.535   -0.93   -0.13   0.414      -0.39      -0.48      -0.30
#&gt; 5   -65 0.257   -0.42   -0.34   0.896      -0.62      -0.31      -0.59
#&gt; 6   -67 0.306   -0.53   -0.21   0.039      -0.51      -0.74      -0.58
#&gt; 7   -67 0.676   -1.01   -0.55   0.966      -0.40      -0.34      -0.44
#&gt; 8   -66 0.201   -0.91    0.03   0.572      -0.51      -0.29      -0.28
#&gt; 9   -66 0.112   -0.86   -0.10   0.336      -0.55      -0.38      -0.43
#&gt; 10  -66 0.667   -0.42   -0.24   0.796      -0.43      -0.46      -0.38
#&gt; # ... with 3990 more draws, and 97 more variables
#&gt; # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</div><div class='input'>
<span class='co'># or can specify 'format' argument to avoid manual conversion</span>
<span class='no'>draws</span> <span class='kw'>&lt;-</span> <span class='no'>fit</span>$<span class='fu'>draws</span>(<span class='kw'>format</span> <span class='kw'>=</span> <span class='st'>"df"</span>)

<span class='co'># can select specific parameters</span>
<span class='no'>fit</span>$<span class='fu'>draws</span>(<span class='st'>"alpha"</span>)</div><div class='output co'>#&gt; # A draws_array: 1000 iterations, 4 chains, and 1 variables
#&gt; , , variable = alpha
#&gt; 
#&gt;          chain
#&gt; iteration     1    2    3    4
#&gt;         1 0.016 0.57 0.27 0.25
#&gt;         2 0.831 0.38 0.61 0.42
#&gt;         3 0.302 0.42 0.27 0.38
#&gt;         4 0.535 0.68 0.16 0.55
#&gt;         5 0.257 0.37 0.23 0.26
#&gt; 
#&gt; # ... with 995 more iterations</div><div class='input'><span class='no'>fit</span>$<span class='fu'>draws</span>(<span class='st'>"beta"</span>)  <span class='co'># selects entire vector beta</span></div><div class='output co'>#&gt; # A draws_array: 1000 iterations, 4 chains, and 3 variables
#&gt; , , variable = beta[1]
#&gt; 
#&gt;          chain
#&gt; iteration     1     2      3     4
#&gt;         1 -0.76 -1.03 -0.836 -0.49
#&gt;         2 -0.66 -1.18 -1.239 -0.69
#&gt;         3 -0.35 -0.48 -0.086 -0.90
#&gt;         4 -0.93 -0.98 -0.188 -0.91
#&gt;         5 -0.42 -0.29 -0.792 -0.42
#&gt; 
#&gt; , , variable = beta[2]
#&gt; 
#&gt;          chain
#&gt; iteration     1      2      3     4
#&gt;         1 -0.27 -0.538  0.092 -0.58
#&gt;         2 -0.51  0.087 -0.079 -0.23
#&gt;         3 -0.45 -0.540 -0.435 -0.33
#&gt;         4 -0.13 -0.623 -0.534 -0.17
#&gt;         5 -0.34 -0.191  0.028 -0.34
#&gt; 
#&gt; , , variable = beta[3]
#&gt; 
#&gt;          chain
#&gt; iteration    1    2    3    4
#&gt;         1 0.55 1.27 0.93 0.43
#&gt;         2 1.05 0.85 0.47 0.38
#&gt;         3 0.77 0.92 0.98 1.21
#&gt;         4 0.41 1.10 0.97 0.27
#&gt;         5 0.90 0.88 0.32 0.95
#&gt; 
#&gt; # ... with 995 more iterations</div><div class='input'><span class='no'>fit</span>$<span class='fu'>draws</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"alpha"</span>, <span class='st'>"beta[2]"</span>))</div><div class='output co'>#&gt; # A draws_array: 1000 iterations, 4 chains, and 2 variables
#&gt; , , variable = alpha
#&gt; 
#&gt;          chain
#&gt; iteration     1    2    3    4
#&gt;         1 0.016 0.57 0.27 0.25
#&gt;         2 0.831 0.38 0.61 0.42
#&gt;         3 0.302 0.42 0.27 0.38
#&gt;         4 0.535 0.68 0.16 0.55
#&gt;         5 0.257 0.37 0.23 0.26
#&gt; 
#&gt; , , variable = beta[2]
#&gt; 
#&gt;          chain
#&gt; iteration     1      2      3     4
#&gt;         1 -0.27 -0.538  0.092 -0.58
#&gt;         2 -0.51  0.087 -0.079 -0.23
#&gt;         3 -0.45 -0.540 -0.435 -0.33
#&gt;         4 -0.13 -0.623 -0.534 -0.17
#&gt;         5 -0.34 -0.191  0.028 -0.34
#&gt; 
#&gt; # ... with 995 more iterations</div><div class='input'>
<span class='co'># can be passed directly to bayesplot plotting functions</span>
<span class='fu'><a href='https://mc-stan.org/bayesplot/reference/MCMC-distributions.html'>mcmc_dens</a></span>(<span class='no'>fit</span>$<span class='fu'>draws</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"alpha"</span>, <span class='st'>"beta"</span>)))</div><div class='img'><img src='fit-method-draws-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://mc-stan.org/bayesplot/reference/MCMC-scatterplots.html'>mcmc_scatter</a></span>(<span class='no'>fit</span>$<span class='fu'>draws</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"beta[1]"</span>, <span class='st'>"beta[2]"</span>)), <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.3</span>)</div><div class='img'><img src='fit-method-draws-2.png' alt='' width='700' height='433' /></div><div class='input'># }

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jonah Gabry, Rok Češnovar.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


